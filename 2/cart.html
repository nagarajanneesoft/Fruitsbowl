<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Shopping Cart - Love Fruits Bowl</title>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />

    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 80px 10px;
        background: #f5f7fa;
      }

      header {
        background: #fff;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        z-index: 999;
      }
      .navbar-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 20px;
      }
      .logo {
        display: flex;
        align-items: center;
        text-decoration: none;
        color: #28a745;
        font-weight: bold;
      }
      .logo-img {
        width: 36px;
        height: 36px;
        margin-right: 8px;
        border-radius: 50%;
      }

      .cart-container {
        background: #fff;
        border-radius: 15px;
        padding: 20px;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
      }

      .quantity-btn {
        background: #28a745;
        color: #fff;
        border: none;
        width: 30px;
        height: 30px;
        border-radius: 5px;
      }

      .remove-btn {
        border: none;
        background: transparent;
        color: #dc3545;
      }

      .checkout-btn {
        background: linear-gradient(45deg, #56ab2f, #a8e063);
        color: #fff;
        border: none;
        padding: 10px 20px;
        border-radius: 30px;
        font-size: 14px;
        text-decoration: none;
      }

      .checkout-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(86, 171, 47, 0.4);
        background: linear-gradient(45deg, #4a8f2a, #96d658);
      }

      .table th,
      .table td {
        vertical-align: middle;
        font-size: 0.8rem;
      }
      .form-control {
        font-size: 0.8rem;
      }

      @media (min-width: 768px) {
        .cart-container {
          max-width: 1100px;
          margin: auto;
        }
      }
    </style>
  </head>

  <body>
    <header>
      <div class="navbar-container">
        <a href="index.html" class="logo">
          <img src="logo.jpeg" class="logo-img" /> Love Fruits Bowl
        </a>
      </div>
    </header>

    <div class="cart-container">
      <div class="row">
        <!-- LEFT SIDE CART TABLE -->
        <div class="col-md-6">
          <div id="cartItems"></div>
        </div>

        <!-- RIGHT SIDE SUMMARY -->
        <div class="col-md-6">
          <div id="cartSummary"></div>
        </div>
      </div>
    </div>

    <!-- Checkout Modal -->
    <div class="modal fade" id="addressModal">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h6 style="padding: 0; margin: 0">Delivery Details</h6>
            <button class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <input
              id="custName"
              class="form-control mb-3"
              placeholder="Customer Name"
            />
            <input
              id="custPhone"
              class="form-control mb-3"
              placeholder="Phone Number"
            />
            <textarea
              id="deliveryAddress"
              class="form-control mb-3"
              rows="3"
              placeholder="Delivery Address"
            ></textarea>

            <h6 class="fw-bold mb-2" style="font-size: 0.8rem">
              Payment Method
            </h6>

            <select
              id="paymentMethod"
              class="form-select mb-3 form-control"
              onchange="toggleUPI()"
            >
              <option value="COD">Cash On Delivery</option>
              <!-- <option value="UPI">UPI Payment</option> -->
            </select>

            <div id="upiSection" style="display: none" class="text-center">
              <p class="fw-bold text-success">Scan & Pay</p>
              <img src="upi-qr.png" width="200" class="img-fluid mb-2" />
              <p>UPI ID: yourupi@okaxis</p>
              <small>Please pay before confirming order</small>
            </div>
          </div>
          <div class="modal-footer">
            <button class="checkout-btn w-100" onclick="proceedToCheckout()">
              Confirm Order
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
      let cart = JSON.parse(localStorage.getItem("fruitsCart")) || [];

      function updateCartDisplay() {
        let cartItems = document.getElementById("cartItems");
        let cartSummary = document.getElementById("cartSummary");

        if (cart.length === 0) {
          cartItems.innerHTML = `
<div class="text-center py-4">
<img src="https://assets-v2.lottiefiles.com/a/0953d504-117d-11ee-aa49-1f149204cb5f/9uZcoEJaoF.gif"
style="width:150px" class="mb-3">
<h6>Cart Empty</h6>
<p>Add some fresh fruits to continue shopping</p>
<a href="index.html" class="checkout-btn btn-sm mt-2">
Continue Shopping
</a>
</div>`;
          cartSummary.innerHTML = "";
          return;
        }

        let html = `
<table class="table table-bordered text-center">
<thead class="table-success">
<tr>
<th>Product</th>
<th>Qty</th>
<th>Price</th>
<th>Action</th>
</tr>
</thead>
<tbody>
`;

        let total = 0;
        let items = 0;

        cart.forEach((item, i) => {
          items += item.quantity;
          total += item.price * item.quantity;

          html += `
<tr>
<td><b>${item.name}</b></td>

<td>
<button class="quantity-btn" onclick="updateQuantity(${i},-1)">-</button>
<span class="mx-2">${item.quantity}</span>
<button class="quantity-btn" onclick="updateQuantity(${i},1)">+</button>
</td>

<td>‚Çπ${item.price * item.quantity}</td>

<td>
<button class="remove-btn" onclick="removeFromCart(${i})">
<i class="fas fa-trash"></i>
</button>
</td>
</tr>`;
        });

        html += "</tbody></table>";
        cartItems.innerHTML = html;

        let deliveryFee = total >= 199 ? 0 : 20;
        let grandTotal = total + deliveryFee;

        cartSummary.innerHTML = `
<table class="table table-bordered text-center">
<thead class="table-success">
<tr><th colspan="2">Order Summary</th></tr>
</thead>
<tbody>
<tr><td>Total Items</td><td>${items}</td></tr>
<tr><td>Subtotal</td><td>‚Çπ${total}</td></tr>
<tr>
<td>Delivery Fee</td>
<td>‚Çπ${deliveryFee} ${deliveryFee === 0 ? "(Free Delivery)" : "(Above ‚Çπ199 Free)"}</td>
</tr>
<tr class="fw-bold">
<td>Grand Total</td>
<td>‚Çπ${grandTotal}</td>
</tr>
</tbody>
</table>

<div class="d-flex justify-content-between mt-3">

<a href="#" class="checkout-btn"
data-bs-toggle="modal"
data-bs-target="#addressModal">
<i class="fab fa-whatsapp me-1"></i> Checkout via WhatsApp
</a>

<a href="index.html" class="checkout-btn">
Continue Shopping
</a>

</div>`;
      }

      function updateQuantity(i, val) {
        cart[i].quantity += val;
        if (cart[i].quantity <= 0) cart.splice(i, 1);
        saveCart();
        updateCartDisplay();
      }

      function removeFromCart(i) {
        cart.splice(i, 1);
        saveCart();
        updateCartDisplay();
      }

      function saveCart() {
        localStorage.setItem("fruitsCart", JSON.stringify(cart));
      }

      // Start
      function proceedToCheckout() {
        const name = document.getElementById("custName").value.trim();
        const phone = document.getElementById("custPhone").value.trim();
        const address = document.getElementById("deliveryAddress").value.trim();
        const payment = document.getElementById("paymentMethod").value;

        if (!name || !phone || !address) {
          alert("Please fill delivery details");
          return;
        }

        let msg = "*Cart Order - Love Fruits Bowl*%0A%0A";

        let total = 0;
        let items = 0;

        cart.forEach((item) => {
          items += item.quantity;
          total += item.price * item.quantity;

          msg += `> ü•ó ${item.name}\n`;
          msg += `Qty: ${item.quantity}\n`;
          msg += `‚Çπ${item.price * item.quantity}\n\n`;
        });

        let deliveryFee = total >= 199 ? 0 : 20;
        let grandTotal = total + deliveryFee;

        msg += `> üì¶ Total Items: ${items}\n`;
        msg += `> üí∞ Subtotal: ‚Çπ${total}\n`;
        msg += `> üöö Delivery Fee: ‚Çπ${deliveryFee}\n`;
        msg += `> üí∞ Total Amount: ‚Çπ${grandTotal}\n\n`;

        msg += `> üë§ Name: ${name}\n`;
        msg += `> üìû Phone: ${phone}\n`;
        msg += `> üè† Address: ${address}\n`;
        msg += `> üí≥ Payment: ${payment}\n\n`;

        msg += "Please confirm this order\n";
        msg += "‚úÖ Yes - Confirm Order\n";
        msg += "‚ùå No - Cancel Order";

        const whatsappURL = `https://wa.me/9047343441?text=${encodeURIComponent(msg)}`;

        window.open(whatsappURL, "_blank");

        bootstrap.Modal.getInstance(
          document.getElementById("addressModal"),
        )?.hide();
      }

      // Initialize cart display
      updateCartDisplay();
      // End
    </script>
  </body>
</html>
