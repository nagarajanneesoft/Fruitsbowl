<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/png" sizes="" href="favicon.ico" />
    <title>Product Management - Love Fruits Bowl</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      body {
        background: #f8f9fa;
        font-family: "Inter", sans-serif;
      }
      .admin-header {
        background: linear-gradient(135deg, #56ab2f 0%, #a8e063 100%);
        color: white;
        padding: 2rem 0;
        margin-bottom: 2rem;
      }
      .product-form {
        background: white;
        border-radius: 15px;
        padding: 2rem;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        margin-bottom: 2rem;
      }
      .product-list {
        background: white;
        border-radius: 15px;
        padding: 2rem;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
      }
      .product-item {
        border: 1px solid #e0e0e0;
        border-radius: 10px;
        padding: 1rem;
        margin-bottom: 1rem;
        transition: all 0.3s ease;
      }
      .product-item:hover {
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        transform: translateY(-2px);
      }
      .badge-available {
        background: #28a745;
      }
      .badge-unavailable {
        background: #dc3545;
      }
      .btn-action {
        padding: 0.25rem 0.5rem;
        font-size: 0.875rem;
        margin: 0 0.25rem;
      }
      .form-control:focus {
        border-color: #56ab2f;
        box-shadow: 0 0 0 0.2rem rgba(86, 171, 47, 0.25);
      }
      .alert-success {
        background: linear-gradient(45deg, #28a745, #20c997);
        border: none;
        color: white;
      }
    </style>
  </head>
  <body>
    <header class="admin-header">
      <div class="container">
        <div class="row align-items-center">
          <div class="col">
            <h1 class="mb-0">
              <i class="fas fa-cogs me-2"></i>
              Product Management
            </h1>
            <p class="mb-0 opacity-75">Manage your fruit bowl products</p>
          </div>
          <div class="col-auto">
            <a href="index.html" class="btn btn-light">
              <i class="fas fa-store me-2"></i>
              View Store
            </a>
          </div>
        </div>
      </div>
    </header>

    <div class="container">
      <div class="row">
        <div class="col-lg-4">
          <div class="product-form">
            <h4 class="mb-4">
              <i class="fas fa-plus-circle me-2"></i>
              Add/Edit Product
            </h4>
            <form id="productForm">
              <input type="hidden" id="productId" />

              <div class="mb-3">
                <label for="productName" class="form-label"
                  >Product Name *</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="productName"
                  required
                />
              </div>

              <div class="mb-3">
                <label for="productDescription" class="form-label"
                  >Description *</label
                >
                <textarea
                  class="form-control"
                  id="productDescription"
                  rows="3"
                  required
                ></textarea>
              </div>

              <div class="mb-3">
                <label for="productPrice" class="form-label">Price (₹) *</label>
                <input
                  type="number"
                  class="form-control"
                  id="productPrice"
                  min="0"
                  step="0.01"
                  required
                />
              </div>

              <div class="mb-3">
                <label for="productImage" class="form-label">Image URL *</label>
                <input
                  type="url"
                  class="form-control"
                  id="productImage"
                  required
                />
              </div>

              <div class="mb-3">
                <label for="productCategory" class="form-label"
                  >Category *</label
                >
                <select class="form-control" id="productCategory" required>
                  <option value="">Select category...</option>
                  <option value="fruits">Fruits</option>
                  <option value="sprouts">Sprouts</option>
                  <option value="juice">Juice</option>
                  <option value="salad">Salad</option>
                  <option value="box">Box</option>
                </select>
              </div>

              <div class="mb-3">
                <label for="productBadge" class="form-label"
                  >Badge (Optional)</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="productBadge"
                  placeholder="e.g., Popular, New, Healthy"
                />
              </div>

              <div class="mb-3">
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    id="productAvailable"
                    checked
                  />
                  <label class="form-check-label" for="productAvailable">
                    Available for sale
                  </label>
                </div>
              </div>

              <div class="d-grid gap-2">
                <button type="submit" class="btn btn-success">
                  <i class="fas fa-save me-2"></i>
                  Save Product
                </button>
                <button
                  type="button"
                  class="btn btn-secondary"
                  onclick="resetForm()"
                >
                  <i class="fas fa-undo me-2"></i>
                  Reset Form
                </button>
              </div>
            </form>
          </div>
        </div>

        <div class="col-lg-8">
          <div class="product-list">
            <div class="d-flex justify-content-between align-items-center mb-4">
              <h4 class="mb-0">
                <i class="fas fa-list me-2"></i>
                Products List
              </h4>
              <span class="badge bg-primary" id="productCount">0 products</span>
            </div>

            <div id="productsList">
              <!-- Products will be loaded here -->
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Success Message -->
    <div class="position-fixed top-0 end-0 p-3" style="z-index: 1050">
      <div
        id="successAlert"
        class="alert alert-success alert-dismissible fade show"
        style="display: none"
      >
        <i class="fas fa-check-circle me-2"></i>
        <span id="successMessage">Product saved successfully!</span>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="alert"
        ></button>
      </div>
    </div>

    <script src="products.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      // Load and display products
      function loadProducts() {
        const products = getAllProducts();
        const productsList = document.getElementById("productsList");
        const productCount = document.getElementById("productCount");

        productCount.textContent = `${products.length} products`;

        if (products.length === 0) {
          productsList.innerHTML = `
                    <div class="text-center py-5">
                        <i class="fas fa-box-open fa-3x text-muted mb-3"></i>
                        <h5 class="text-muted">No products found</h5>
                        <p class="text-muted">Add your first product using the form</p>
                    </div>
                `;
          return;
        }

        productsList.innerHTML = products
          .map(
            (product) => `
                <div class="product-item">
                    <div class="row align-items-center">
                        <div class="col-auto">
                            <img src="${product.image}" alt="${product.name}" 
                                 style="width: 60px; height: 60px; object-fit: cover; border-radius: 8px;">
                        </div>
                        <div class="col">
                            <h5 class="mb-1">${product.name}</h5>
                            <p class="mb-1 text-muted">${product.description}</p>
                            <div class="d-flex align-items-center gap-2">
                                <span class="badge bg-primary">${product.category}</span>
                                <span class="badge ${product.available ? "badge-available" : "badge-unavailable"}">
                                    ${product.available ? "Available" : "Unavailable"}
                                </span>
                                ${product.badge ? `<span class="badge bg-info">${product.badge}</span>` : ""}
                                <span class="fw-bold text-success">₹${product.price}</span>
                            </div>
                        </div>
                        <div class="col-auto">
                            <button class="btn btn-sm btn-primary btn-action" onclick="editProduct('${product.id}')">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="btn btn-sm btn-danger btn-action" onclick="deleteProduct('${product.id}')">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </div>
                    </div>
                </div>
            `,
          )
          .join("");
      }

      // Edit product
      function editProduct(productId) {
        const product = getProduct(productId);
        if (!product) return;

        document.getElementById("productId").value = product.id;
        document.getElementById("productName").value = product.name;
        document.getElementById("productDescription").value =
          product.description;
        document.getElementById("productPrice").value = product.price;
        document.getElementById("productImage").value = product.image;
        document.getElementById("productCategory").value = product.category;
        document.getElementById("productBadge").value = product.badge || "";
        document.getElementById("productAvailable").checked = product.available;

        // Scroll to form
        document
          .querySelector(".product-form")
          .scrollIntoView({ behavior: "smooth" });
      }

      // Delete product
      function deleteProduct(productId) {
        if (!confirm("Are you sure you want to delete this product?")) return;

        const product = getProduct(productId);
        if (!product) return;

        // Remove from products array
        const index = products.findIndex((p) => p.id === productId);
        if (index !== -1) {
          products.splice(index, 1);
          saveProducts();
          loadProducts();
          showSuccess(`Product "${product.name}" deleted successfully!`);
        }
      }

      // Reset form
      function resetForm() {
        document.getElementById("productForm").reset();
        document.getElementById("productId").value = "";
      }

      // Show success message
      function showSuccess(message) {
        const alert = document.getElementById("successAlert");
        const messageElement = document.getElementById("successMessage");
        messageElement.textContent = message;
        alert.style.display = "block";

        setTimeout(() => {
          alert.style.display = "none";
        }, 3000);
      }

      // Handle form submission
      document
        .getElementById("productForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const productId = document.getElementById("productId").value;
          const productData = {
            name: document.getElementById("productName").value,
            description: document.getElementById("productDescription").value,
            price: parseFloat(document.getElementById("productPrice").value),
            image: document.getElementById("productImage").value,
            category: document.getElementById("productCategory").value,
            badge: document.getElementById("productBadge").value,
            available: document.getElementById("productAvailable").checked,
          };

          if (productId) {
            // Update existing product
            updateProduct(productId, productData);
            showSuccess(`Product "${productData.name}" updated successfully!`);
          } else {
            // Add new product
            const newProduct = {
              id: productData.name
                .toLowerCase()
                .replace(/\s+/g, "-")
                .replace(/[^a-z0-9-]/g, ""),
              ...productData,
            };
            addProduct(newProduct);
            showSuccess(`Product "${productData.name}" added successfully!`);
          }

          resetForm();
          loadProducts();
        });

      // Initialize on page load
      document.addEventListener("DOMContentLoaded", function () {
        loadProducts();
      });
    </script>
  </body>
</html>
